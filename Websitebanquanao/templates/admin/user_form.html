{% extends "base.html" %}

{% block title %}{% if user %}Sửa tài khoản{% else %}Thêm tài khoản{% endif %} - Admin{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-2xl">
    <h1 class="text-3xl font-bold mb-6">{% if user %}Sửa tài khoản{% else %}Thêm tài khoản mới{% endif %}</h1>

    <div class="bg-white rounded-2xl shadow-sm p-6">
        <form method="POST">
            <!-- Email -->
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Email *</label>
                <input type="email" name="email" value="{{ user.email if user else '' }}" 
                       {% if user %}readonly{% endif %}
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 {% if user %}bg-gray-100{% endif %}" 
                       required>
            </div>

            <!-- Name -->
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Họ và tên *</label>
                <input type="text" name="name" value="{{ user.name if user else '' }}" 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                       required>
            </div>

            <!-- Phone -->
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Số điện thoại</label>
                <input type="tel" name="phone" value="{{ user.phone if user else '' }}" 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Address -->
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Địa chỉ</label>
                <textarea name="address" rows="3" 
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">{{ user.address if user else '' }}</textarea>
            </div>

            <!-- Role -->
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Vai trò *</label>
                <select name="role" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                    <option value="user" {% if user and user.role == 'user' %}selected{% endif %}>Khách hàng</option>
                    <option value="staff" {% if user and user.role == 'staff' %}selected{% endif %}>Nhân viên</option>
                    <option value="admin" {% if user and user.role == 'admin' %}selected{% endif %}>Admin</option>
                </select>
            </div>

            <!-- Password (only for new users or if changing) -->
            {% if not user %}
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Mật khẩu *</label>
                <input type="password" name="password" 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                       required>
            </div>
            {% else %}
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Mật khẩu mới (để trống nếu không đổi)</label>
                <input type="password" name="new_password" 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
            {% endif %}

            <div class="flex space-x-4">
                <button type="submit" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">
                    {% if user %}Cập nhật{% else %}Thêm tài khoản{% endif %}
                </button>
                <a href="/admin/users" class="flex-1 bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300 transition text-center">
                    Hủy
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
